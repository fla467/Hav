<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Hopscotch Viewer</title>

<link href="https://fonts.googleapis.com/css2?family=Permanent+Marker&display=swap" rel="stylesheet">

<style>
body {
    margin: 0;
    font-family: "Permanent Marker", cursive;
    text-align: center;
    background: #ffffff;
    color: #000;
}

/* HOME SCREEN */
#home {
    padding-top: 80px;
}

button {
    padding: 15px 25px;
    margin: 10px;
    font-size: 22px;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    font-family: "Permanent Marker", cursive;
}

.old-btn { background: #3498db; }
.new-btn { background: #2ecc71; }

.hidden { display: none; }

iframe {
    width: 90%;
    height: 600px;
    border: 3px solid #555;
    border-radius: 12px;
    margin-top: 20px;
    display: none;
}

/* FOLLOW THE DEV BUTTON */
#followDev {
    position: fixed;
    top: 40%;
    left: -160px;
    padding: 15px 25px;
    background: #ff4dd2;
    border-radius: 0 12px 12px 0;
    transition: 0.35s ease;
    z-index: 9999;
    font-size: 22px;
}

#followDev:hover {
    left: 0;
}

#followDev a {
    color: white;
    text-decoration: none;
}

/* DARK MODE */
.dark {
    background: #1a1a1a;
    color: white;
}
.dark iframe {
    border-color: #888;
}

/* ANIMATED ERROR POPUP */
#errorPopup {
    position: fixed;
    top: -200px;
    left: 50%;
    transform: translateX(-50%);
    background: #e74c3c;
    color: white;
    padding: 20px 50px;
    border-radius: 16px;
    font-size: 26px;
    box-shadow: 0 5px 20px rgba(0,0,0,0.3);
    transition: 0.4s;
    z-index: 9999;
}
#errorPopup.show {
    top: 40px;
}

#footer {
    margin-top: 40px;
    font-size: 18px;
    opacity: 0.7;
}
</style>
</head>

<body>

<!-- FOLLOW DEV BUTTON (GLOBAL) -->
<div id="followDev">
    <a href="https://www.gethopscotch.com/6811491" target="_blank">Follow the Dev</a>
</div>

<!-- HOME SCREEN -->
<div id="home">
    <h1>Hopscotch Viewer</h1>
    <button class="old-btn" onclick="openOld()">Old Mode</button>
    <button class="new-btn" onclick="openNew()">New Mode</button>
</div>

<!-- ERROR POPUP -->
<div id="errorPopup">Invalid URL Entered!</div>

<!-- OLD MODE -->
<div id="oldMode" class="hidden">
    <h2>Old Mode (Embedded Only)</h2>
    <input id="oldInput" placeholder="Enter URL or UUID" style="padding:10px;font-size:20px;width:70%;">
    <button onclick="loadOldProject()" class="old-btn">Load</button>

    <iframe id="oldFrame"></iframe>
</div>

<!-- NEW MODE -->
<div id="newMode" class="hidden">
    <h2>New Mode</h2>

    <button onclick="toggleDark()" style="background:#ffbb00;">Toggle Dark Mode</button>
    <br><br>

    <input id="newInput" placeholder="Enter URL or UUID" style="padding:10px;font-size:20px;width:70%;">
    <button onclick="loadNewEmbedded()" class="new-btn">Embedded</button>
    <button onclick="loadNewFull()" style="background:#8e44ad;color:white;">Full Project</button>

    <iframe id="newFrame"></iframe>
</div>

<div id="footer">Not an official partnership with Hopscotch</div>

<script>
function openOld() {
    home.style.display = "none";
    oldMode.style.display = "block";
}
function openNew() {
    home.style.display = "none";
    newMode.style.display = "block";
}

/* Extract UUID from URL */
function getUUID(x) {
    const match = x.match(/[0-9A-Fa-f\-]{36}/);
    return match ? match[0] : null;
}

/* ERROR POPUP */
function showError() {
    errorPopup.classList.add("show");
    setTimeout(() => errorPopup.classList.remove("show"), 2000);
}

/* OLD MODE LOADING */
function loadOldProject() {
    let input = oldInput.value;
    let uuid = getUUID(input);
    if (!uuid) return showError();

    oldFrame.src = "https://ae-hopscotch.github.io/hs-tools/play-project/?id=" + uuid;
    oldFrame.style.display = "block";
}

/* NEW MODE EMBEDDED */
function loadNewEmbedded() {
    let input = newInput.value;
    let uuid = getUUID(input);
    if (!uuid) return showError();

    newFrame.src = "https://ae-hopscotch.github.io/hs-tools/play-project/?id=" + uuid;
    newFrame.style.display = "block";
}

/* NEW MODE FULL PROJECT */
function loadNewFull() {
    let input = newInput.value;
    let uuid = getUUID(input);
    if (!uuid) return showError();

    window.open("https://ae-hopscotch.github.io/hs-tools/play-project/?id=" + uuid, "_blank");
}

/* DARK MODE TOGGLE */
function toggleDark() {
    document.body.classList.toggle("dark");
}
</script>

</body>
</html>
